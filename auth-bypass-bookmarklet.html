<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authentication Bypass Bookmarklet</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            color: #2c3e50;
            border-bottom: 2px solid #e74c3c;
            padding-bottom: 10px;
        }
        .card {
            background-color: #f9f9f9;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .warning {
            background-color: #fff3cd;
            color: #856404;
            border-left: 4px solid #ffc107;
            padding: 12px;
            margin-bottom: 20px;
        }
        .danger {
            background-color: #f8d7da;
            color: #721c24;
            border-left: 4px solid #dc3545;
            padding: 12px;
            margin-bottom: 20px;
        }
        .bookmarklet {
            display: inline-block;
            background-color: #3498db;
            color: white;
            padding: 10px 15px;
            border-radius: 4px;
            text-decoration: none;
            font-weight: bold;
            margin: 20px 0;
        }
        .bookmarklet:hover {
            background-color: #2980b9;
        }
        .instructions {
            margin-top: 20px;
        }
        .instructions ol {
            padding-left: 20px;
        }
        .instructions li {
            margin-bottom: 10px;
        }
        code {
            background-color: #f8f9fa;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>Authentication Bypass Bookmarklet</h1>
    
    <div class="danger">
        <strong>Warning:</strong> This tool completely disables authentication checks in the application. 
        It is for development and testing purposes only and should never be used in production.
    </div>

    <div class="card">
        <h2>Authentication Bypass Bookmarklet</h2>
        <p>Drag this bookmarklet to your bookmarks bar:</p>
        
        <a id="bookmarklet" class="bookmarklet" href="#">Auth Bypass</a>
        
        <div class="instructions">
            <h3>How to use:</h3>
            <ol>
                <li>Drag the "Auth Bypass" button above to your bookmarks bar</li>
                <li>Navigate to your application at <code>http://localhost:5173</code></li>
                <li>Click the bookmarklet in your bookmarks bar</li>
                <li>The authentication bypass will be applied immediately</li>
                <li>You can now access protected routes like users, roles, and permissions</li>
            </ol>
        </div>
    </div>

    <div class="card">
        <h2>How It Works</h2>
        <p>This bookmarklet:</p>
        <ol>
            <li>Injects a script that overrides React's authentication context</li>
            <li>Forces all authentication checks to return true</li>
            <li>Provides a mock admin user with all permissions</li>
            <li>Works on any page in your application</li>
        </ol>
    </div>

    <script>
        // Generate the bookmarklet code
        document.addEventListener('DOMContentLoaded', function() {
            const bypassCode = `
                (function() {
                    // Create a mock admin user
                    const mockUser = {
                        id: 'admin-bypass-123',
                        username: 'admin',
                        email: 'admin@example.com',
                        firstName: 'Admin',
                        lastName: 'User',
                        fullName: 'Admin User',
                        role: 'ADMIN',
                        roles: ['ADMIN'],
                        permissions: ['*'],
                        isActive: true,
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString(),
                        lastLogin: new Date().toISOString()
                    };

                    // Store mock user in localStorage
                    localStorage.setItem('auth_token', 'bypass-token');
                    localStorage.setItem('auth_user', JSON.stringify(mockUser));
                    localStorage.setItem('token', 'bypass-token');

                    console.log('[AUTH BYPASS] Initializing authentication bypass...');

                    // Override authentication context
                    if (window.React) {
                        console.log('[AUTH BYPASS] React detected, overriding authentication...');
                        
                        // Override authentication context
                        const originalCreateContext = React.createContext;
                        React.createContext = function(defaultValue, calculateChangedBits) {
                            const context = originalCreateContext(defaultValue, calculateChangedBits);
                            
                            // Check if this is the auth context
                            if (defaultValue && 
                                (defaultValue.hasOwnProperty('isAuthenticated') || 
                                defaultValue.hasOwnProperty('user'))) {
                                
                                console.log('[AUTH BYPASS] Detected Auth Context, overriding with bypass values');
                                
                                // Override the Provider component
                                const OriginalProvider = context.Provider;
                                context.Provider = function({ children, value, ...props }) {
                                    // Create bypass auth context
                                    const bypassValue = {
                                        user: mockUser,
                                        isAuthenticated: true,
                                        isLoading: false,
                                        error: null,
                                        permissions: ['*'],
                                        isDevelopmentMode: true,
                                        isBypassEnabled: true,
                                        login: async () => ({ success: true }),
                                        logout: async () => {},
                                        hasPermission: () => true,
                                        hasRole: () => true,
                                        refreshAuth: async () => true,
                                        restoreAuth: () => {},
                                        clearAuthError: () => {}
                                    };
                                    
                                    // Merge with original value to maintain other properties
                                    const mergedValue = { ...value, ...bypassValue };
                                    
                                    return React.createElement(OriginalProvider, {
                                        value: mergedValue,
                                        ...props
                                    }, children);
                                };
                            }
                            
                            return context;
                        };
                        
                        // Override Protected Route component if it exists
                        const originalCreateElement = React.createElement;
                        React.createElement = function(type, props, ...children) {
                            // Check if this is a ProtectedRoute component
                            if (type && type.name === 'ProtectedRoute') {
                                console.log('[AUTH BYPASS] Detected ProtectedRoute, bypassing protection');
                                // Just render the children directly
                                return children[0];
                            }
                            
                            return originalCreateElement.apply(this, [type, props, ...children]);
                        };
                        
                        console.log('[AUTH BYPASS] Authentication bypass complete');
                        alert('Authentication bypass applied successfully!');
                    } else {
                        console.log('[AUTH BYPASS] React not detected, reloading page...');
                        alert('React not detected. Reloading page to apply bypass...');
                        window.location.reload();
                    }
                })();
            `;
            
            // Create the bookmarklet URL
            const bookmarkletUrl = 'javascript:' + encodeURIComponent(bypassCode);
            
            // Set the href attribute of the bookmarklet link
            document.getElementById('bookmarklet').href = bookmarkletUrl;
        });
    </script>
</body>
</html>
